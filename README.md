# NacosExploit

Nacos 综合利用工具

### ⚖️ 前情提要

**本工具仅用于学习和交流。**

**由于传播、利用此工具所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。**

> 注：工具现在还只是一个 beta 版本 🤣 haha，代码也不够美观，等有空了整理一下再传上来。

### 📃 漏洞列表

| 漏洞编号        | 漏洞名称                            | 是否支持 |
| --------------- | ----------------------------------- | :------: |
|                 | Nacos 默认未开启认证                |    ✅    |
|                 | Nacos 默认密码（忘了这一茬了...）   |    ❌    |
| CVE-2021-29441  | Nacos 认证绕过（User-Agent 白名单） |    ✅    |
| QVD-2023-6271   | Nacos 认证绕过（JWT 默认密钥）      |    ✅    |
| CNVD-2020-67618 | Nacos Derby SQL 注入                |    ✅    |
|                 | Nacos Client Yaml 反序列化          |    ⚠️    |
| QVD-2023-13065  | Nacos JRaft Hessian 反序列化        |    ⚠️    |

> ✅：支持检测和利用。
>
> ⚠️：检测通过 nacos api 获取版本来进行判断，具体是否可以利用，需要实际进行利用后才知道。
>
> ❌：当前不支持。

### 🔍 FOFA 语法

```
app="NACOS"
```

### 💻 使用示例

漏洞检测：

![alt text](README.assets/image.png)

Nacos Derby SQL 注入：

![alt text](README.assets/image-1.png)

Nacos Client Yaml 反序列化：

![alt text](README.assets/image-2.png)

...

### 🔗 参考项目

> "Nacos JRaft Hessian 反序列化" 没玩明白，直接用的以下师傅们的代码 ✌️

- [https://github.com/c0olw/NacosRce](https://github.com/c0olw/NacosRce)
- [https://github.com/crumbledwall/nacos-hessian-rce-exp](https://github.com/crumbledwall/nacos-hessian-rce-exp)
- [https://github.com/charonlight/NacosExploitGUI](https://github.com/charonlight/NacosExploitGUI)
