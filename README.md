## NacosExploit

Nacos 综合利用工具【[Release 下载地址](https://github.com/h0ny/NacosExploit/releases)】

[![Author](https://img.shields.io/badge/author-h0ny-red.svg "Author")](https://github.com/h0ny "Author")
[![Visitors](https://visitor-badge.laobi.icu/badge?page_id=h0ny.NacosExploit "Visitors")](https://github.com/h0ny/NacosExploit "Visitors")
[![Stars](https://img.shields.io/github/stars/h0ny/NacosExploit.svg?style=flat&label=Stars "Stars")](https://github.com/h0ny/NacosExploit "Stars")
![GitHub License](https://img.shields.io/github/license/h0ny/NacosExploit)

### 前情提要

**本工具仅用于学习和交流。**

**由于传播、利用此工具所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。**

### FOFA 语法

```
app="NACOS"
```

### 漏洞列表

| 漏洞编号        | 漏洞名称                            | 是否支持 |
| --------------- | ----------------------------------- | :------: |
|                 | Nacos 默认未开启认证                |    ✅    |
|                 | Nacos 默认密码   |    ✅    |
| CVE-2021-29441  | Nacos 认证绕过（User-Agent 白名单） |    ✅    |
| AVD-2023-1655789<br />QVD-2023-6271 | Nacos 认证绕过（JWT 默认密钥）      |    ✅    |
| CNVD-2020-67618 | Nacos Derby SQL 注入                |    ✅    |
|                 | Nacos Client Yaml 反序列化          |    ⚠️    |
| QVD-2023-13065  | Nacos JRaft Hessian 反序列化        |    ❌    |

> ✅：支持检测和利用。
>
> ⚠️：不支持漏洞检测的漏洞。
>
> ❌：暂不支持的漏洞。

### 使用示例

漏洞检测：

![image-20240819160201946](README.assets/image-20240819160201946.png)

Nacos 认证绕过：（支持一键导出所有命名空间的配置文件） 

![image-20240819160312572](README.assets/image-20240819160312572.png)

Nacos Derby SQL 注入：（不出网注入内存马，无 jar 落地；支持使用JMG生成的base64内存马）

![image-20240819160305896](README.assets/image-20240819160305896.png)

Nacos Client Yaml 反序列化：（支持不出网利用，写入恶意 yaml-payload.jar 至目标主机）

![image-20240819160211538](README.assets/image-20240819160211538.png)

### 特别感谢

感谢 [@wh!te?be6ar](https://github.com/whitebear-ch) 哥提供 Nacos Derby SQL 注入无 jar 落地注入内存马的 payload。
